<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>starting five</title>

<style>
body {
  margin:0;
  background: radial-gradient(circle at top, #1a1a1a, #000);
  font-family: system-ui;
  color:white;
  overflow:hidden;
}

.container {
  width:100vw;
  height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}

.starters {
  display:flex;
  gap:60px;
  margin-bottom:60px;
}

.card {
  text-align:center;
  animation: fadeIn 0.6s ease forwards;
}

.card img {
  width:220px;
  height:220px;
  object-fit:cover;
  border-radius:20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.7);
}

.name {
  margin-top:14px;
  font-size:22px;
  font-weight:800;
}

.bench {
  display:flex;
  gap:30px;
  flex-wrap:wrap;
  justify-content:center;
  font-size:18px;
  opacity:0.8;
}

@keyframes fadeIn {
  from {opacity:0; transform:translateY(30px);}
  to {opacity:1; transform:translateY(0);}
}
</style>
</head>

<body>
<div class="container">
  <div class="starters" id="starters"></div>
  <div class="bench" id="bench"></div>
</div>

<script>
let lastSeq = -1;

async function getProfile(name){
  const r = await fetch(`http://127.0.0.1:5001/api/player_profile?name=${encodeURIComponent(name)}`);
  return await r.json();
}

async function load(){
  const res = await fetch("http://127.0.0.1:5001/api/lineup_state?ts="+Date.now());
  const j = await res.json();
  if (!j.ok) return;

  if (j.seq === lastSeq) return;
  lastSeq = j.seq;

  const s = j.state || { starters:[], bench:[] };

  const startersEl = document.getElementById("starters");
  const benchEl = document.getElementById("bench");

  startersEl.innerHTML = "";
  benchEl.innerHTML = "";

  // STARTERS
  for (const p of s.starters){
    const prof = await getProfile(p.name);

    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <img src="${p.photo}">
      <div class="name">${p.name}</div>
      <div>${prof.position || ""} • ${prof.height || ""}</div>
      <div style="font-size:14px;opacity:0.7;">
  ${prof.stats.ppg || 0} PPG |
  ${prof.stats.rpg || 0} RPG |
  ${prof.stats.apg || 0} APG
</div>
<div style="font-size:12px;opacity:0.6;">
  ${prof.stats.fg_pct || 0}% FG • ${prof.stats.gp || 0} GP
</div>

    `;
    startersEl.appendChild(div);
  }

  // BENCH (with images now)
  for (const p of s.bench){
    const prof = await getProfile(p.name);

    const div = document.createElement("div");
    div.className = "card";
    div.style.opacity = "0.8";

    div.innerHTML = `
      <img src="${p.photo}" style="width:140px;height:140px;">
      <div class="name">${p.name}</div>
      <div>${prof.position || ""} • ${prof.height || ""}</div>
      <div style="font-size:12px;opacity:0.7;">
  ${prof.stats.ppg || 0} PPG |
  ${prof.stats.rpg || 0} RPG |
  ${prof.stats.apg || 0} APG
</div>

    `;

    benchEl.appendChild(div);
  }
}

setInterval(load, 1000);
load();

</script>
</body>
</html>
